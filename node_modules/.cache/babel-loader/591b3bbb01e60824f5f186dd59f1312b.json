{"ast":null,"code":"/**\n * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\n/**\n * @module typing/utils/findattributerange\n */\n\n/**\n * Returns a model range that covers all consecutive nodes with the same `attributeName` and its `value`\n * that intersect the given `position`.\n *\n * It can be used e.g. to get the entire range on which the `linkHref` attribute needs to be changed when having a\n * selection inside a link.\n *\n * @param {module:engine/model/position~Position} position The start position.\n * @param {String} attributeName The attribute name.\n * @param {String} value The attribute value.\n * @param {module:engine/model/model~Model} model The model instance.\n * @returns {module:engine/model/range~Range} The link range.\n */\nexport default function findAttributeRange(position, attributeName, value, model) {\n  return model.createRange(_findBound(position, attributeName, value, true, model), _findBound(position, attributeName, value, false, model));\n} // Walks forward or backward (depends on the `lookBack` flag), node by node, as long as they have the same attribute value\n// and returns a position just before or after (depends on the `lookBack` flag) the last matched node.\n//\n// @param {module:engine/model/position~Position} position The start position.\n// @param {String} attributeName The attribute name.\n// @param {String} value The attribute value.\n// @param {Boolean} lookBack Whether the walk direction is forward (`false`) or backward (`true`).\n// @returns {module:engine/model/position~Position} The position just before the last matched node.\n\nfunction _findBound(position, attributeName, value, lookBack, model) {\n  // Get node before or after position (depends on `lookBack` flag).\n  // When position is inside text node then start searching from text node.\n  let node = position.textNode || (lookBack ? position.nodeBefore : position.nodeAfter);\n  let lastNode = null;\n\n  while (node && node.getAttribute(attributeName) == value) {\n    lastNode = node;\n    node = lookBack ? node.previousSibling : node.nextSibling;\n  }\n\n  return lastNode ? model.createPositionAt(lastNode, lookBack ? 'before' : 'after') : position;\n}","map":{"version":3,"sources":["/Users/oyejin/Surfee/kiwi/node_modules/@ckeditor/ckeditor5-typing/src/utils/findattributerange.js"],"names":["findAttributeRange","position","attributeName","value","model","createRange","_findBound","lookBack","node","textNode","nodeBefore","nodeAfter","lastNode","getAttribute","previousSibling","nextSibling","createPositionAt"],"mappings":"AAAA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASA,kBAAT,CAA6BC,QAA7B,EAAuCC,aAAvC,EAAsDC,KAAtD,EAA6DC,KAA7D,EAAqE;AACnF,SAAOA,KAAK,CAACC,WAAN,CACNC,UAAU,CAAEL,QAAF,EAAYC,aAAZ,EAA2BC,KAA3B,EAAkC,IAAlC,EAAwCC,KAAxC,CADJ,EAENE,UAAU,CAAEL,QAAF,EAAYC,aAAZ,EAA2BC,KAA3B,EAAkC,KAAlC,EAAyCC,KAAzC,CAFJ,CAAP;AAIA,C,CAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,SAASE,UAAT,CAAqBL,QAArB,EAA+BC,aAA/B,EAA8CC,KAA9C,EAAqDI,QAArD,EAA+DH,KAA/D,EAAuE;AACtE;AACA;AACA,MAAII,IAAI,GAAGP,QAAQ,CAACQ,QAAT,KAAuBF,QAAQ,GAAGN,QAAQ,CAACS,UAAZ,GAAyBT,QAAQ,CAACU,SAAjE,CAAX;AAEA,MAAIC,QAAQ,GAAG,IAAf;;AAEA,SAAQJ,IAAI,IAAIA,IAAI,CAACK,YAAL,CAAmBX,aAAnB,KAAsCC,KAAtD,EAA8D;AAC7DS,IAAAA,QAAQ,GAAGJ,IAAX;AACAA,IAAAA,IAAI,GAAGD,QAAQ,GAAGC,IAAI,CAACM,eAAR,GAA0BN,IAAI,CAACO,WAA9C;AACA;;AAED,SAAOH,QAAQ,GAAGR,KAAK,CAACY,gBAAN,CAAwBJ,QAAxB,EAAkCL,QAAQ,GAAG,QAAH,GAAc,OAAxD,CAAH,GAAuEN,QAAtF;AACA","sourcesContent":["/**\n * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\n/**\n * @module typing/utils/findattributerange\n */\n\n/**\n * Returns a model range that covers all consecutive nodes with the same `attributeName` and its `value`\n * that intersect the given `position`.\n *\n * It can be used e.g. to get the entire range on which the `linkHref` attribute needs to be changed when having a\n * selection inside a link.\n *\n * @param {module:engine/model/position~Position} position The start position.\n * @param {String} attributeName The attribute name.\n * @param {String} value The attribute value.\n * @param {module:engine/model/model~Model} model The model instance.\n * @returns {module:engine/model/range~Range} The link range.\n */\nexport default function findAttributeRange( position, attributeName, value, model ) {\n\treturn model.createRange(\n\t\t_findBound( position, attributeName, value, true, model ),\n\t\t_findBound( position, attributeName, value, false, model )\n\t);\n}\n\n// Walks forward or backward (depends on the `lookBack` flag), node by node, as long as they have the same attribute value\n// and returns a position just before or after (depends on the `lookBack` flag) the last matched node.\n//\n// @param {module:engine/model/position~Position} position The start position.\n// @param {String} attributeName The attribute name.\n// @param {String} value The attribute value.\n// @param {Boolean} lookBack Whether the walk direction is forward (`false`) or backward (`true`).\n// @returns {module:engine/model/position~Position} The position just before the last matched node.\nfunction _findBound( position, attributeName, value, lookBack, model ) {\n\t// Get node before or after position (depends on `lookBack` flag).\n\t// When position is inside text node then start searching from text node.\n\tlet node = position.textNode || ( lookBack ? position.nodeBefore : position.nodeAfter );\n\n\tlet lastNode = null;\n\n\twhile ( node && node.getAttribute( attributeName ) == value ) {\n\t\tlastNode = node;\n\t\tnode = lookBack ? node.previousSibling : node.nextSibling;\n\t}\n\n\treturn lastNode ? model.createPositionAt( lastNode, lookBack ? 'before' : 'after' ) : position;\n}\n"]},"metadata":{},"sourceType":"module"}